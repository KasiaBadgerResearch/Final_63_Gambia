# How has female enrolment in primary education evolved relative to the number of female teachers in primary education in the Gambia between 1971 and 2019?

import pandas as pd
import matplotlib.pyplot as plt
import os

# Folders
data_raw_folder = "data_raw/"
data_clean_folder = "data_clean/"
figures_folder = "figures/"

# Load CSV
filename = "education_gmb_filtered.csv"  # Filtered dataset with only relevant rows
df = pd.read_csv(os.path.join(data_raw_folder, filename))

# Keep only needed columns
df = df[["Year", "Indicator Name", "Value"]]

# Convert Year and Value to numeric, drop invalid rows
df["Year"] = pd.to_numeric(df["Year"], errors="coerce")
df["Value"] = pd.to_numeric(df["Value"], errors="coerce")
df = df.dropna(subset=["Year", "Value"])

# Pivot indicators into separate columns
df_pivot = df.pivot(index="Year", columns="Indicator Name", values="Value").reset_index()
df_pivot = df_pivot.sort_values("Year")

print("Pivoted Gambia dataset:")
display(df_pivot)

# Interpolate missing values for smooth plotting (optional)
df_plot = df_pivot.interpolate(method='linear')

# Plot the indicators
plt.figure(figsize=(10,6))
plt.plot(df_plot["Year"], df_plot["Enrolment in primary education, female (number)"], 
         marker='o', linestyle='-', label="Enrolment in primary education, female (number)")
plt.plot(df_plot["Year"], df_plot["Teachers in primary education, female (number)"], 
         marker='o', linestyle='-', label="Teachers in primary education, female (number)")

plt.title("Gambia: Female enrolment vs Female teachers in primary education (number) (1971-2019)")
plt.xlabel("Year")
plt.ylabel("Number")
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.savefig(os.path.join(figures_folder, "gambia_female_enrolment_vs_female_teachers_in_primary_education.png"))
plt.show()

# Save cleaned CSV
df_pivot.to_csv(os.path.join(data_clean_folder, "gambia_female_enrolment_vs_female_teachers_in_primary_education"), index=False)
